#!/usr/bin/env bash

set -e

MAX_RETRIES=5
DELAY=5

for i in $(seq 1 "$MAX_RETRIES"); do
  echo "Attempt $i/$MAX_RETRIES: Running command: $*"
  if "$@"; then
    echo "✅ Command succeeded on attempt $i."
    exit 0
  fi
  if [ "$i" -lt "$MAX_RETRIES" ]; then
    echo "❌ Command failed. Retrying in $DELAY seconds..."
    sleep "$DELAY"
  fi
done

echo "❌ Command failed after $MAX_RETRIES attempts."
exit 1
