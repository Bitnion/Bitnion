---
name: "bitnion-linux"
enable_cache: true
suites:
  - focal
architectures:
  - amd64
packages:
  - build-essential
  - libtool
  - autotools-dev
  - automake
  - pkg-config
  - libssl-dev
  - libevent-dev
  - bsdmainutils
  - python3
  - libboost-system-dev
  - libboost-filesystem-dev
  - libboost-chrono-dev
  - libboost-test-dev
  - libboost-thread-dev
  - libdb-dev
  - libdb++-dev
  - libminiupnpc-dev
  - git
  - curl
  - cmake
  - g++-multilib
  - unzip
  - zlib1g-dev

reference_datetime: "2025-01-01 00:00:00"

remotes:
  - url: https://github.com/bitnion/bitnion.git
    dir: bitnion

files: []

script: |
  set -e

  echo "[bitnion-linux] Starting deterministic build for Bitnion Linux binaries."

  cd bitnion
  ./autogen.sh

  ./configure --prefix=$PWD/depends/x86_64-pc-linux-gnu \
              --disable-tests \
              --without-gui \
              --enable-static

  echo "[bitnion-linux] Configuration complete. Building..."

  make -j$(nproc)

  echo "[bitnion-linux] Build complete. Copying binaries..."

  mkdir -p $OUTDIR/bin
  cp src/bitniond $OUTDIR/bin/
  cp src/bitnion-cli $OUTDIR/bin/
  cp src/bitnion-tx $OUTDIR/bin/

  echo "[bitnion-linux] Binaries copied to \$OUTDIR/bin:"
  ls -lh $OUTDIR/bin/

  echo "[bitnion-linux] Bitnion Linux Gitian build finished successfully."
